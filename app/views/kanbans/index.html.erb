<div class ="row g-0">
  <div class="col-2">
    <div class="d-flex flex-column mt-n5 ms-n3 p-3 bg-light sidenav">
      <div class="d-flex justify-content-between">
        <strong class="px-2">My Boards:</strong>
        <%= link_to new_kanban_path, class: "link-dark new-board" do %>
          <div class="px-2">+</div>
        <% end %>
      </div>
      <hr>
      <ul class="nav nav-pills flex-column">
       <% @kanbans.each_with_index do |kanban, index| %>
          <li class="nav-item">

            <%= link_to kanban.name, kanbans_path(kanban_id: kanban), 
            class: "nav-link link-dark #{
              if params[:kanban_id].nil? && index == 0
                "active"
              elsif kanban.id == params[:kanban_id].to_i
                "active"
              end
            }"%>

          </li>
        <% end %>
      </ul>
    </div>
  </div>

  <div class="col-10">
    <div class="mt-n4">
      <div class="mb-2 d-flex justify-content-around">
        <div>
          <%# <strong>Name: </strong> %>
          <%= @kanban.name %>
          <%= link_to '', edit_kanban_path(@kanban), class: "bi bi-pencil-square" %>
        </div>

        <div>
          metrics
          <%= link_to '', kanban_metrics_index_path(@kanban), class: "bi bi-bar-chart-line-fill" %>
        </div>

      </div>

      <% if false %>
        <%= form_with url: kanban_sort_path, method: :patch do |f|%>
          <%= f.text_field 'kanban[kanbanIds]', class: "kanban-form-input" %>
          <%= f.submit "Saved changes" %>
        <% end %>
      <% end %>

      <div class="kanban" data-id="<%= @kanban.id %>">
        <% @kanban.kanban_columns.each do |column| %>
          <ul class="kanban-col border" data-col-id=<%= column.id %>>

            <div class="kanban-col-name text-light"><%= column.name %></div>
            <%= link_to new_kanban_card_path(@kanban, :kanban_column_id => column.id) do%>
              <div class="kanban-col-add text-light">+</div>
            <%end%>

            <% column.cards.sort_by{ |card| card.position}.each do |item| %>
              <%= link_to edit_kanban_card_path(@kanban, item.id) do%>
                  <li class="kanban-col-item card" data-item-id=<%= item.id %>>
                    <div class="d-flex justify-content-between">
                      <strong><%= item.job_title %></strong>
                      <%= link_to '', kanban_card_path(@kanban, item.id), method: :delete, data: { confirm: 'Are you sure?' }, class: "bi bi-trash-fill text-danger ps-1" %>
                    </div>

                    <small class="text-muted"><%= item.company %></small>
                  </li>
              <%end%>
            <%end%>

          </ul>
        <% end %>
      </div>
    </div>
  </div>
</div>

<% if false %>
  <div class="col-lg-8 col-md-8 col-sm-9 mx-auto">
    <table class="table table-hover caption-top border">
      <caption>My Boards:</caption>

      <thead class="table-primary">
        <tr>
          <th class="">Name</th>
          <th class="text-center">Edit</th>
          <th class="text-center" >Delete</th>
        </tr>
      </thead>

      <tbody>
        <% @kanbans.each do |kanban| %>
          <tr>
            <td class=""><%= link_to kanban.name, kanbans_path(kanban_id: kanban), class: "fw-bold"%></td>
            <td class="text-center"><%= link_to '', edit_kanban_path(kanban), class: "bi bi-pencil-square" %></td>
            <td class="text-center"><%= link_to '', kanban, method: :delete, data: { confirm: 'Are you sure?' }, class: "bi bi-trash-fill text-danger" %></td>
          </tr>
        <% end %>
          <tr>
            <td colspan="3" class="text-center"><%= link_to '+ new board', new_kanban_path, class: "fw-bold" %></td>
          </tr>
      </tbody>
    </table>
  </div>
<% end %>